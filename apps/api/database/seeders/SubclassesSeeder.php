<?php

namespace Database\Seeders;

use App\Models\CharacterClass;
use App\Models\Setting;
use Illuminate\Database\Seeder;

class SubclassesSeeder extends Seeder
{
    public function run(): void
    {
        $eberron = Setting::where('slug', 'eberron')->first();

        // Note: Druid circles moved to DruidClassSeeder
        // Note: Rogue archetypes moved to RogueClassSeeder
        $this->seedRangerArchetypes($eberron);
        $this->seedWizardSchools($eberron);
        $this->seedArtificer($eberron);
    }

    private function seedDruidCircles(?Setting $eberron): void
    {
        $subclasses = [
            [
                'slug' => 'circle-of-the-land',
                'name' => ['ru' => 'Круг Земли'],
                'parent_slug' => 'druid',
                'description' => ['ru' => 'Круг Земли состоит из мистиков и мудрецов, хранящих древние знания и обряды. Их магия находится под влиянием земли, на которой они были посвящены.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'bonus_cantrip', 'name' => 'Дополнительный заговор', 'description' => 'Вы узнаёте один дополнительный заговор друида на ваш выбор.'],
                        ['key' => 'natural_recovery', 'name' => 'Естественное восстановление', 'description' => 'Во время короткого отдыха вы можете восстановить часть магических сил. Выберите потраченные ячейки заклинаний, сумма уровней которых не превышает половину вашего уровня друида (округляя в большую сторону). Вы не можете восстановить ячейки 6 уровня и выше. Использовать можно один раз за продолжительный отдых.'],
                    ],
                    '3' => [
                        ['key' => 'circle_spells', 'name' => 'Заклинания круга', 'description' => 'Ваша связь с землёй даёт вам доступ к определённым заклинаниям. Выберите тип местности: арктика, побережье, пустыня, лес, луг, гора, болото или Подземье.', 'type' => 'choice'],
                    ],
                    '6' => [
                        ['key' => 'lands_stride', 'name' => 'Путь по земле', 'description' => 'Перемещение по немагической труднопроходимой местности не требует дополнительного перемещения. Вы также можете проходить сквозь немагические растения без замедления и без получения урона от шипов.'],
                    ],
                    '10' => [
                        ['key' => 'natures_ward', 'name' => 'Защита природы', 'description' => 'Вы не можете быть очарованы или испуганы элементалями или фей, и вы получаете иммунитет к яду и болезням.'],
                    ],
                    '14' => [
                        ['key' => 'natures_sanctuary', 'name' => 'Святилище природы', 'description' => 'Существа природного мира чувствуют вашу связь с природой и не решаются атаковать вас. Когда зверь или растение атакует вас, оно должно совершить спасбросок Мудрости против Сл ваших заклинаний друида.'],
                    ],
                ],
            ],
            [
                'slug' => 'circle-of-the-moon',
                'name' => ['ru' => 'Круг Луны'],
                'parent_slug' => 'druid',
                'description' => ['ru' => 'Друиды Круга Луны — непреклонные хранители дикой природы. Они обладают способностью превращаться в более могущественных зверей и используют эту способность в бою.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'combat_wild_shape', 'name' => 'Боевой дикий облик', 'description' => 'Вы можете использовать Дикий облик бонусным действием. Кроме того, находясь в диком облике, вы можете бонусным действием потратить одну ячейку заклинаний, чтобы восстановить 1d8 хитов за каждый уровень потраченной ячейки.'],
                        ['key' => 'circle_forms', 'name' => 'Формы круга', 'description' => 'Вы можете принимать облик зверя с показателем опасности 1 (без ограничения на перемещение). Начиная с 6 уровня — ОП = уровень друида / 3 (округляя вниз).'],
                    ],
                    '6' => [
                        ['key' => 'primal_strike', 'name' => 'Первобытный удар', 'description' => 'Ваши атаки в диком облике считаются магическими для целей преодоления сопротивления и иммунитета к немагическим атакам.'],
                    ],
                    '10' => [
                        ['key' => 'elemental_wild_shape', 'name' => 'Элементальный дикий облик', 'description' => 'Вы можете потратить два использования Дикого облика, чтобы превратиться в воздушного, водного, земляного или огненного элементаля.'],
                    ],
                    '14' => [
                        ['key' => 'thousand_forms', 'name' => 'Тысяча форм', 'description' => 'Вы можете накладывать заклинание Изменение облика по желанию, не тратя ячейку заклинаний.'],
                    ],
                ],
            ],
            [
                'slug' => 'circle-of-spores',
                'name' => ['ru' => 'Круг Спор'],
                'parent_slug' => 'druid',
                'description' => ['ru' => 'Друиды Круга Спор находят красоту в разложении, видя в нём часть великого цикла жизни. Они используют силу грибов и спор, управляя процессами гниения и перерождения.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'halo_of_spores', 'name' => 'Ореол спор', 'description' => 'Вы окружены невидимыми некротическими спорами. Когда существо, которое вы видите, перемещается в пространство в пределах 3 м от вас или начинает там ход, вы можете реакцией заставить его совершить спасбросок Телосложения. При провале существо получает 1d4 некротического урона (1d6 на 6 уровне, 1d8 на 10, 1d10 на 14).'],
                        ['key' => 'symbiotic_entity', 'name' => 'Симбиотическая сущность', 'description' => 'Вы можете действием потратить использование Дикого облика, чтобы пробудить споры. Вы получаете 4 временных хита за каждый уровень друида, урон Ореола спор удваивается, и ваши рукопашные атаки оружием наносят дополнительно 1d6 некротического урона.'],
                    ],
                    '6' => [
                        ['key' => 'fungal_infestation', 'name' => 'Грибное заражение', 'description' => 'Если зверь или гуманоид с ОП 1 или ниже умирает в пределах 3 м от вас, вы можете реакцией оживить его спорами. Существо поднимается с 1 хитом, считается растением и действует сразу после вашего хода.'],
                    ],
                    '10' => [
                        ['key' => 'spreading_spores', 'name' => 'Распространяющиеся споры', 'description' => 'Вы можете бонусным действием создать куб спор со стороной 3 м в точке в пределах 9 м. Пока Симбиотическая сущность активна, вы можете использовать Ореол спор для существ в этом кубе.'],
                    ],
                    '14' => [
                        ['key' => 'fungal_body', 'name' => 'Грибное тело', 'description' => 'Вы не можете быть ослеплены, оглушены, испуганы или отравлены. Критические попадания по вам считаются обычными попаданиями, если только вы не недееспособны.'],
                    ],
                ],
            ],
            [
                'slug' => 'circle-of-stars',
                'name' => ['ru' => 'Круг Звёзд'],
                'parent_slug' => 'druid',
                'description' => ['ru' => 'Друиды Круга Звёзд черпают силу из древних звёздных карт и созвездий. Они изучают небесные тела и используют их энергию для усиления своей магии.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'star_map', 'name' => 'Звёздная карта', 'description' => 'Вы создаёте звёздную карту — крошечный предмет, который служит фокусом для заклинаний друида. Держа карту, вы знаете заговор Руководство. Вы можете сотворить Направленный снаряд без траты ячейки заклинаний число раз, равное бонусу мастерства.'],
                        ['key' => 'starry_form', 'name' => 'Звёздная форма', 'description' => 'Бонусным действием вы можете потратить использование Дикого облика, чтобы принять звёздную форму вместо превращения в зверя. Выберите созвездие: Лучник (1d8+МДР к атаке заклинанием раз в ход), Чаша (исцеление 1d8+МДР при заклинании), или Дракон (минимум 10 на проверках концентрации и полёта).'],
                    ],
                    '6' => [
                        ['key' => 'cosmic_omen', 'name' => 'Космическое предзнаменование', 'description' => 'После продолжительного отдыха бросьте кость. Чёт — Горе: реакцией вычтите d6 из броска атаки, спасброска или проверки, которые вы видите. Нечёт — Радость: добавить d6. Число раз = бонус мастерства.'],
                    ],
                    '10' => [
                        ['key' => 'twinkling_constellations', 'name' => 'Мерцающие созвездия', 'description' => 'Кости звёздной формы становятся 2d8. В начале каждого хода в звёздной форме вы можете сменить созвездие.'],
                    ],
                    '14' => [
                        ['key' => 'full_of_stars', 'name' => 'Полный звёзд', 'description' => 'В звёздной форме вы становитесь частично бестелесным, получая сопротивление дробящему, колющему и рубящему урону.'],
                    ],
                ],
            ],
            [
                'slug' => 'circle-of-the-shepherd',
                'name' => ['ru' => 'Круг Пастыря'],
                'parent_slug' => 'druid',
                'description' => ['ru' => 'Друиды Круга Пастыря общаются с духами природы, особенно с духами зверей и фей. Они призывают духов-тотемов, которые защищают и усиливают их союзников.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'speech_of_the_woods', 'name' => 'Речь леса', 'description' => 'Вы получаете способность говорить на Сильване. Звери понимают вашу речь и вы получаете преимущество на проверки Харизмы при взаимодействии с ними.'],
                        ['key' => 'spirit_totem', 'name' => 'Дух-тотем', 'description' => 'Бонусным действием вы можете призвать бестелесного духа в точку в пределах 18 м. Аура радиусом 9 м: Медведь (временные хиты = 5 + уровень друида), Ястреб (преимущество на атаки против врагов в ауре), Единорог (преимущество на проверки способностей для обнаружения, хиты исцеления +ваш уровень друида).'],
                    ],
                    '6' => [
                        ['key' => 'mighty_summoner', 'name' => 'Могучий призыватель', 'description' => 'Звери и феи, призванные вашими заклинаниями, получают +2 хита за каждую Кость Здоровья и их атаки считаются магическими.'],
                    ],
                    '10' => [
                        ['key' => 'guardian_spirit', 'name' => 'Дух-хранитель', 'description' => 'Когда зверь или фея в вашей ауре Духа-тотема восстанавливает хиты, они восстанавливают дополнительно число хитов, равное половине вашего уровня друида.'],
                    ],
                    '14' => [
                        ['key' => 'faithful_summons', 'name' => 'Верные призывы', 'description' => 'Когда вы опускаетесь до 0 хитов или становитесь недееспособны, вы можете немедленно получить эффект заклинания Призыв зверей 9 уровня. 4 зверя появляются в пределах 6 м и охраняют вас. Раз за продолжительный отдых.'],
                    ],
                ],
            ],
            [
                'slug' => 'circle-of-dreams',
                'name' => ['ru' => 'Круг Снов'],
                'parent_slug' => 'druid',
                'description' => ['ru' => 'Друиды Круга Снов имеют связь со Страной Фей и благословлены силами, дарованными духами этого царства. Их магия исцеляет и защищает усталых и слабых.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'balm_of_the_summer_court', 'name' => 'Бальзам Летнего двора', 'description' => 'У вас есть запас целительной энергии фей, равный 5 × уровень друида d6. Бонусным действием выберите существо в пределах 36 м и потратьте кости (максимум = половина уровня друида). Существо восстанавливает хиты и получает 1 временный хит за каждую потраченную кость.'],
                    ],
                    '6' => [
                        ['key' => 'hearth_of_moonlight_and_shadow', 'name' => 'Очаг лунного света и тени', 'description' => 'В начале отдыха вы можете создать зону радиусом 9 м. Вы и союзники получают +5 к проверкам Скрытности и Внимательности, и свет от открытого огня не выходит за пределы зоны.'],
                    ],
                    '10' => [
                        ['key' => 'hidden_paths', 'name' => 'Скрытые тропы', 'description' => 'Бонусным действием вы телепортируетесь на 18 м в видимую точку, или касаетесь согласного существа и телепортируете его на 9 м. Число раз = бонус мастерства за продолжительный отдых.'],
                    ],
                    '14' => [
                        ['key' => 'walker_in_dreams', 'name' => 'Странник снов', 'description' => 'После короткого отдыха вы можете сотворить одно заклинание без ячейки: Сон, Наблюдение или Телепортационный круг (связанный с последним местом отдыха). Раз за продолжительный отдых.'],
                    ],
                ],
            ],
            [
                'slug' => 'circle-of-wildfire',
                'name' => ['ru' => 'Круг Дикого Огня'],
                'parent_slug' => 'druid',
                'description' => ['ru' => 'Друиды Круга Дикого Огня понимают, что разрушение иногда предшествует созиданию. Они призывают огненных духов для уничтожения врагов и исцеления союзников через очищающее пламя.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'circle_spells_wildfire', 'name' => 'Заклинания круга', 'description' => 'Вы всегда имеете подготовленными: Огненные ладони, Пылающий шар (2), Растительный рост, Возрождение (3), Огненная аура, Огненный щит (4), Пламенный удар, Массовое лечение ран (5).'],
                        ['key' => 'summon_wildfire_spirit', 'name' => 'Призыв духа дикого огня', 'description' => 'Действием потратьте использование Дикого облика, чтобы призвать духа дикого огня. Он появляется в пределах 9 м, и каждое существо в пределах 3 м от него должно преуспеть в спасброске Ловкости или получить 2d6 огненного урона.'],
                    ],
                    '6' => [
                        ['key' => 'enhanced_bond', 'name' => 'Усиленная связь', 'description' => 'Заклинания, наносящие огненный урон или восстанавливающие хиты, получают +1d8 к одному броску урона или исцеления, пока дух призван. Вы можете творить через духа как через себя.'],
                    ],
                    '10' => [
                        ['key' => 'cauterizing_flames', 'name' => 'Прижигающее пламя', 'description' => 'Когда существо в пределах 9 м от вас или духа умирает, вы можете реакцией создать призрачное пламя. Когда существо входит в пламя, оно восстанавливает 2d10+МДР хитов или получает 2d10+МДР огненного урона.'],
                    ],
                    '14' => [
                        ['key' => 'blazing_revival', 'name' => 'Пылающее возрождение', 'description' => 'Если дух в пределах 36 м от вас и вы падаете до 0 хитов, дух погибает и вы восстанавливаете половину хитов и поднимаетесь. Раз за продолжительный отдых.'],
                    ],
                ],
            ],
        ];

        foreach ($subclasses as $data) {
            $subclass = CharacterClass::updateOrCreate(
                ['slug' => $data['slug']],
                array_merge($data, [
                    'hit_die' => 'd8',
                    'is_spellcaster' => true,
                    'spellcasting_ability' => 'wisdom',
                    'is_system' => true,
                ])
            );

            if ($eberron) {
                $subclass->settings()->syncWithoutDetaching([$eberron->id]);
            }
        }

        $this->command->info('Druid circles seeded: 7 circles');
    }

    private function seedRangerArchetypes(?Setting $eberron): void
    {
        $subclasses = [
            [
                'slug' => 'hunter',
                'name' => ['ru' => 'Охотник'],
                'parent_slug' => 'ranger',
                'description' => ['ru' => 'Принятие архетипа охотника означает принятие вашего места в качестве оплота между цивилизацией и ужасами дикой природы.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'hunters_prey', 'name' => 'Добыча охотника', 'type' => 'choice', 'description' => 'Выберите одну способность: Убийца колоссов (+1d8 урона по существам с максимумом хитов), Убийца гигантов (преимущество на спасброски от крупных), Убийца орды (+атака по другому врагу рядом).'],
                    ],
                    '7' => [
                        ['key' => 'defensive_tactics', 'name' => 'Защитная тактика', 'type' => 'choice', 'description' => 'Выберите: Побег от орды (провокация не даёт преимущества), Защита от мультиатаки (+4 КД против одного врага), Стальная воля (преимущество против испуга).'],
                    ],
                    '11' => [
                        ['key' => 'multiattack', 'name' => 'Мультиатака', 'type' => 'choice', 'description' => 'Выберите: Залп (атака по существам в радиусе 3м) или Вихрь (атака по всем в пределах 1.5м).'],
                    ],
                    '15' => [
                        ['key' => 'superior_hunters_defense', 'name' => 'Превосходная защита охотника', 'type' => 'choice', 'description' => 'Выберите: Уклонение, Встать против прилива (реакция на промах врага), Невероятное уклонение (половина урона при попадании).'],
                    ],
                ],
            ],
            [
                'slug' => 'beast-master',
                'name' => ['ru' => 'Повелитель зверей'],
                'parent_slug' => 'ranger',
                'description' => ['ru' => 'Архетип Повелителя зверей воплощает дружбу между цивилизованными расами и зверями мира. Вы обретаете зверя-компаньона, который сопровождает вас в приключениях.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'rangers_companion', 'name' => 'Компаньон следопыта', 'description' => 'Вы получаете зверя-компаньона с ОП 1/4 или ниже. Он подчиняется вашим командам. В бою зверь действует в вашу очередь. Он может атаковать, когда вы используете команду.'],
                        ['key' => 'primal_companion', 'name' => 'Первобытный компаньон', 'description' => 'Альтернатива: призовите духа зверя в форме Зверя земли (защита), Зверя неба (мобильность) или Зверя моря (плавание).'],
                    ],
                    '7' => [
                        ['key' => 'exceptional_training', 'name' => 'Исключительная подготовка', 'description' => 'Бонусным действием вы можете приказать компаньону совершить Рывок, Отход или Помощь. Атаки компаньона считаются магическими.'],
                    ],
                    '11' => [
                        ['key' => 'bestial_fury', 'name' => 'Звериная ярость', 'description' => 'Когда вы приказываете компаньону атаковать, он может совершить две атаки или использовать Мультиатаку.'],
                    ],
                    '15' => [
                        ['key' => 'share_spells', 'name' => 'Общие заклинания', 'description' => 'Когда вы творите заклинание на себя, вы можете также повлиять на компаньона, если он в пределах 9 м.'],
                    ],
                ],
            ],
            [
                'slug' => 'gloom-stalker',
                'name' => ['ru' => 'Сумрачный охотник'],
                'parent_slug' => 'ranger',
                'description' => ['ru' => 'Сумрачные охотники чувствуют себя как дома в самых тёмных местах: глубоко под землёй, в мрачных аллеях, в первозданных лесах. Они мастера засад и охоты во тьме.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'dread_ambusher', 'name' => 'Ужасающий засадник', 'description' => 'В первый раунд боя вы получаете +бонус МДР к инициативе, +3м скорости и дополнительную атаку с +1d8 урона.'],
                        ['key' => 'umbral_sight', 'name' => 'Сумрачное зрение', 'description' => 'Вы получаете тёмное зрение 18м. Если уже есть — +9м. Вы невидимы для существ, полагающихся на тёмное зрение.'],
                    ],
                    '7' => [
                        ['key' => 'iron_mind', 'name' => 'Железный разум', 'description' => 'Вы получаете владение спасбросками Мудрости. Если уже владеете — выберите Интеллект или Харизму.'],
                    ],
                    '11' => [
                        ['key' => 'stalkers_flurry', 'name' => 'Шквал охотника', 'description' => 'Раз в ход, когда вы промахиваетесь атакой оружием, вы можете совершить ещё одну атаку.'],
                    ],
                    '15' => [
                        ['key' => 'shadowy_dodge', 'name' => 'Теневое уклонение', 'description' => 'Реакцией на атаку вы можете наложить помеху на бросок атаки.'],
                    ],
                ],
            ],
            [
                'slug' => 'horizon-walker',
                'name' => ['ru' => 'Странник горизонта'],
                'parent_slug' => 'ranger',
                'description' => ['ru' => 'Странники горизонта охраняют мир от угроз из других планов. Они ищут порталы и следят, чтобы ничто враждебное не проникло в мир.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'detect_portal', 'name' => 'Обнаружение портала', 'description' => 'Действием вы чувствуете расстояние и направление к ближайшему планарному порталу в пределах 1.5 км. Раз за короткий отдых.'],
                        ['key' => 'planar_warrior', 'name' => 'Планарный воин', 'description' => 'Бонусным действием выберите существо в пределах 9м. Следующее попадание по нему в этом ходу наносит дополнительно 1d8 силового урона (2d8 на 11 уровне).'],
                    ],
                    '7' => [
                        ['key' => 'ethereal_step', 'name' => 'Эфирный шаг', 'description' => 'Бонусным действием вы можете перейти в Эфирный план до конца хода. Раз за короткий отдых.'],
                    ],
                    '11' => [
                        ['key' => 'distant_strike', 'name' => 'Дальний удар', 'description' => 'Когда вы совершаете действие Атака, вы можете телепортироваться на 3м перед каждой атакой. Если атакуете минимум двух существ — дополнительная атака.'],
                    ],
                    '15' => [
                        ['key' => 'spectral_defense', 'name' => 'Призрачная защита', 'description' => 'Реакцией на получение урона вы получаете сопротивление этому урону.'],
                    ],
                ],
            ],
            [
                'slug' => 'monster-slayer',
                'name' => ['ru' => 'Убийца монстров'],
                'parent_slug' => 'ranger',
                'description' => ['ru' => 'Вы посвятили себя охоте на существ ночи и владельцев тёмной магии. Вампиры, оборотни, некроманты — ваша специализация.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'hunters_sense', 'name' => 'Чутьё охотника', 'description' => 'Действием вы определяете иммунитеты, сопротивления и уязвимости существа в пределах 18м. Число раз = бонус МДР за продолжительный отдых.'],
                        ['key' => 'slayers_prey', 'name' => 'Добыча убийцы', 'description' => 'Бонусным действием выберите существо. Первое попадание по нему каждый ход наносит +1d6 урона.'],
                    ],
                    '7' => [
                        ['key' => 'supernatural_defense', 'name' => 'Сверхъестественная защита', 'description' => 'Когда добыча заставляет вас делать спасбросок или пытается схватить, +1d6 к проверке или спасброску.'],
                    ],
                    '11' => [
                        ['key' => 'magic_users_nemesis', 'name' => 'Немезида магов', 'description' => 'Реакцией вы заставляете существо совершить спасбросок Мудрости при попытке телепортироваться или сотворить заклинание. При провале срыв телепортации/заклинания.'],
                    ],
                    '15' => [
                        ['key' => 'slayers_counter', 'name' => 'Контрудар убийцы', 'description' => 'Реакцией на атаку добычи, если вы должны сделать спасбросок, вы немедленно атакуете. При попадании — автоуспех спасброска.'],
                    ],
                ],
            ],
            [
                'slug' => 'swarmkeeper',
                'name' => ['ru' => 'Роевой хранитель'],
                'parent_slug' => 'ranger',
                'description' => ['ru' => 'Вы привязаны к рою духов природы — крошечных существ, которые окружают и защищают вас. Это могут быть насекомые, птички, пикси или что-то более странное.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'gathered_swarm', 'name' => 'Собранный рой', 'description' => 'Раз в ход при попадании атакой оружием: переместить цель на 4.5м по горизонтали, или +1d6 колющего урона, или переместить себя на 1.5м.'],
                        ['key' => 'swarmkeeper_magic', 'name' => 'Магия роя', 'description' => 'Вы всегда знаете: Волшебная рука, Паутина (3), Газообразная форма (5), Арканий глаз (7), Нашествие насекомых (9).'],
                    ],
                    '7' => [
                        ['key' => 'writhing_tide', 'name' => 'Извивающийся прилив', 'description' => 'Бонусным действием вы получаете скорость полёта 3м до конца хода. Число раз = бонус мастерства за продолжительный отдых.'],
                    ],
                    '11' => [
                        ['key' => 'mighty_swarm', 'name' => 'Могучий рой', 'description' => 'Опции Собранного роя усиливаются: перемещение цели опрокидывает её, урон = 1d8, перемещение себя даёт полуукрытие.'],
                    ],
                    '15' => [
                        ['key' => 'swarming_dispersal', 'name' => 'Роевое рассеивание', 'description' => 'Реакцией на получение урона вы сопротивляетесь урону и телепортируетесь на 9м в видимую точку. Число раз = бонус мастерства.'],
                    ],
                ],
            ],
            [
                'slug' => 'fey-wanderer',
                'name' => ['ru' => 'Фей-странник'],
                'parent_slug' => 'ranger',
                'description' => ['ru' => 'Страна Фей наложила на вас свой отпечаток. Ваша магия черпает силу из царства чудес и тайн, и вы странствуете между мирами.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'dreadful_strikes', 'name' => 'Ужасающие удары', 'description' => 'Раз в ход при попадании атакой оружием +1d4 психического урона (1d6 на 11 уровне).'],
                        ['key' => 'otherworldly_glamour', 'name' => 'Иномирное очарование', 'description' => 'Вы добавляете МДР к проверкам Харизмы. Вы также получаете владение одним навыком: Обман, Выступление или Убеждение.'],
                        ['key' => 'fey_wanderer_magic', 'name' => 'Магия фей-странника', 'description' => 'Вы всегда знаете: Очарование личности (3), Туманный шаг (5), Рассеивание магии (7), Изгнание (9), Ложный друг (11).'],
                    ],
                    '7' => [
                        ['key' => 'beguiling_twist', 'name' => 'Обманчивый поворот', 'description' => 'Когда существо в пределах 36м успешно спасается от очарования или испуга, вы реакцией перенаправляете эффект на другое существо в пределах 36м.'],
                    ],
                    '11' => [
                        ['key' => 'fey_reinforcements', 'name' => 'Подкрепление фей', 'description' => 'Вы можете сотворить Призыв фей без ячейки и без концентрации. Раз за продолжительный отдых.'],
                    ],
                    '15' => [
                        ['key' => 'misty_wanderer', 'name' => 'Туманный странник', 'description' => 'Вы можете сотворить Туманный шаг без ячейки, число раз = бонус МДР. Когда творите — можете взять с собой согласное существо.'],
                    ],
                ],
            ],
            [
                'slug' => 'drakewarden',
                'name' => ['ru' => 'Дрейкварден'],
                'parent_slug' => 'ranger',
                'description' => ['ru' => 'Ваша связь с драконами проявилась в виде драконьего компаньона — крылатого дрейка, который следует за вами и сражается рядом.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'draconic_gift', 'name' => 'Драконий дар', 'description' => 'Вы можете говорить, читать и писать на Драконьем. Раз за продолжительный отдых вы можете сотворить Тауматургию без компонентов.'],
                        ['key' => 'drake_companion', 'name' => 'Компаньон-дрейк', 'description' => 'Действием вы призываете дрейка (бонусным после 7 уровня). Выберите тип урона: кислота, холод, огонь, молния или яд. Дрейк может атаковать командой.'],
                    ],
                    '7' => [
                        ['key' => 'bond_of_fang_and_scale', 'name' => 'Связь клыка и чешуи', 'description' => 'Дрейк становится Средним. Вы можете ездить на нём (Маленький/Средний размер). Вы и дрейк получаете сопротивление типу урона дрейка. Дрейк получает укус + урон типа.'],
                    ],
                    '11' => [
                        ['key' => 'drakes_breath', 'name' => 'Дыхание дрейка', 'description' => 'Действием: дрейк выдыхает конус 9м. Существа в зоне: спасбросок Ловкости или 8d6 урона типа дрейка (половина при успехе). Раз за продолжительный отдых или за ячейку 3+ уровня.'],
                    ],
                    '15' => [
                        ['key' => 'perfected_bond', 'name' => 'Совершенная связь', 'description' => 'Дрейк становится Большим и получает скорость полёта 12м. Урон Дыхания = 12d6. Реакцией дрейк может дать вам или себе сопротивление урону.'],
                    ],
                ],
            ],
        ];

        foreach ($subclasses as $data) {
            $subclass = CharacterClass::updateOrCreate(
                ['slug' => $data['slug']],
                array_merge($data, [
                    'hit_die' => 'd10',
                    'is_spellcaster' => true,
                    'spellcasting_ability' => 'wisdom',
                    'is_system' => true,
                ])
            );

            if ($eberron) {
                $subclass->settings()->syncWithoutDetaching([$eberron->id]);
            }
        }

        $this->command->info('Ranger archetypes seeded: 8');
    }

    private function seedRogueArchetypes(?Setting $eberron): void
    {
        $subclasses = [
            [
                'slug' => 'thief',
                'name' => ['ru' => 'Вор'],
                'parent_slug' => 'rogue',
                'description' => ['ru' => 'Вы оттачиваете навыки в воровском искусстве. Взломщики, бандиты, карманники и другие преступники обычно следуют этому архетипу.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'fast_hands', 'name' => 'Быстрые руки', 'description' => 'Вы можете бонусным действием совершить проверку Ловкости рук, использовать воровские инструменты или действие Использовать предмет.'],
                        ['key' => 'second_story_work', 'name' => 'Работа на втором этаже', 'description' => 'Лазание больше не требует дополнительного перемещения. Длина прыжка увеличивается на число футов, равное модификатору Ловкости.'],
                    ],
                    '9' => [
                        ['key' => 'supreme_sneak', 'name' => 'Превосходная скрытность', 'description' => 'Вы совершаете с преимуществом проверки Скрытности, если перемещаетесь не более чем на половину скорости в этом ходу.'],
                    ],
                    '13' => [
                        ['key' => 'use_magic_device', 'name' => 'Использование магических устройств', 'description' => 'Вы можете игнорировать все требования классов, рас и уровней для использования магических предметов.'],
                    ],
                    '17' => [
                        ['key' => 'thiefs_reflexes', 'name' => 'Воровские рефлексы', 'description' => 'Вы можете совершить два хода в первом раунде боя. Первый ход по обычной инициативе, второй — на инициативу минус 10.'],
                    ],
                ],
            ],
            [
                'slug' => 'assassin',
                'name' => ['ru' => 'Убийца'],
                'parent_slug' => 'rogue',
                'description' => ['ru' => 'Вы фокусируете свою подготовку на мрачном искусстве смерти. Шпионы, наёмные убийцы и охотники за головами следуют этому архетипу.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'bonus_proficiencies', 'name' => 'Дополнительные владения', 'description' => 'Вы получаете владение набором отравителя и набором для грима.'],
                        ['key' => 'assassinate', 'name' => 'Убийство', 'description' => 'Преимущество на атаки против существ, ещё не совершивших ход. Попадание по застигнутому врасплох — критическое.'],
                    ],
                    '9' => [
                        ['key' => 'infiltration_expertise', 'name' => 'Мастер проникновения', 'description' => 'Вы можете создать поддельную личность за 7 дней и 25 зм. Документы, история, связи — всё убедительно.'],
                    ],
                    '13' => [
                        ['key' => 'impostor', 'name' => 'Самозванец', 'description' => 'Изучая человека 3 часа, вы можете безупречно копировать его речь, почерк и поведение. Преимущество на проверки Обмана для выдачи себя за него.'],
                    ],
                    '17' => [
                        ['key' => 'death_strike', 'name' => 'Смертельный удар', 'description' => 'При попадании по застигнутому врасплох существу оно должно преуспеть в спасброске Телосложения (Сл 8+ЛОВ+бонус мастерства) или урон удваивается.'],
                    ],
                ],
            ],
            [
                'slug' => 'arcane-trickster',
                'name' => ['ru' => 'Мистический ловкач'],
                'parent_slug' => 'rogue',
                'description' => ['ru' => 'Вы совершенствуете воровские таланты магией. Вы изучаете заклинания школ Иллюзии и Очарования, дополняя свои способности.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'spellcasting', 'name' => 'Колдовство', 'description' => 'Вы изучаете заклинания волшебника. Заговоры: Волшебная рука + 2 на выбор. Заклинания 1 уровня: 3 (школы Иллюзии/Очарования). Способность: Интеллект.'],
                        ['key' => 'mage_hand_legerdemain', 'name' => 'Ловкость волшебной руки', 'description' => 'Волшебная рука невидима. Вы можете засовывать предметы, доставать из карманов, использовать воровские инструменты на расстоянии.'],
                    ],
                    '9' => [
                        ['key' => 'magical_ambush', 'name' => 'Магическая засада', 'description' => 'Если вы скрыты и творите заклинание, цель совершает спасбросок с помехой.'],
                    ],
                    '13' => [
                        ['key' => 'versatile_trickster', 'name' => 'Разносторонний ловкач', 'description' => 'Бонусным действием вы направляете Волшебную руку, чтобы отвлечь существо в пределах 1.5м от руки. Вы получаете преимущество на атаки против него.'],
                    ],
                    '17' => [
                        ['key' => 'spell_thief', 'name' => 'Вор заклинаний', 'description' => 'Реакцией вы можете отменить заклинание 1-4 уровня, направленное на вас. 8 часов можете творить его сами, цель не может. Раз за продолжительный отдых.'],
                    ],
                ],
            ],
            [
                'slug' => 'scout',
                'name' => ['ru' => 'Разведчик'],
                'parent_slug' => 'rogue',
                'description' => ['ru' => 'Вы — мастер выживания, опережающий своих товарищей во время опасных экспедиций. Разведчики одинаково хорошо служат бандитам и армиям.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'skirmisher', 'name' => 'Застрельщик', 'description' => 'Реакцией на конец хода врага в пределах 1.5м вы можете переместиться на половину скорости без провокации.'],
                        ['key' => 'survivalist', 'name' => 'Мастер выживания', 'description' => 'Вы получаете владение Природой и Выживанием. Ваш бонус мастерства удваивается для этих навыков.'],
                    ],
                    '9' => [
                        ['key' => 'superior_mobility', 'name' => 'Превосходная мобильность', 'description' => 'Ваша скорость ходьбы увеличивается на 3м. Если есть скорость лазания или плавания — она тоже +3м.'],
                    ],
                    '13' => [
                        ['key' => 'ambush_master', 'name' => 'Мастер засад', 'description' => 'Преимущество на проверки инициативы. Первое существо, по которому вы попадаете в первом раунде, даёт преимущество всем союзникам.'],
                    ],
                    '17' => [
                        ['key' => 'sudden_strike', 'name' => 'Внезапный удар', 'description' => 'Если вы совершаете действие Атака, вы можете совершить дополнительную атаку бонусным действием. Скрытая атака может применяться дважды за ход.'],
                    ],
                ],
            ],
            [
                'slug' => 'soulknife',
                'name' => ['ru' => 'Мозголом'],
                'parent_slug' => 'rogue',
                'description' => ['ru' => 'Вы пробудили в себе псионические способности. Теперь вы создаёте клинки из чистой психической энергии и телепатически связываетесь с союзниками.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'psionic_power', 'name' => 'Псионическая сила', 'description' => 'У вас есть запас Псионической энергии (d6, количество = бонус мастерства × 2). Можно использовать для Пси-усиленного навыка (+d6 к проверке) и Психического шёпота (телепатия на число часов = кость).'],
                        ['key' => 'psychic_blades', 'name' => 'Психические клинки', 'description' => 'Бонусным действием создаёте клинок: 1d6 психического урона, метательный (18м). Бонусной атакой можете создать второй клинок (1d4).'],
                    ],
                    '9' => [
                        ['key' => 'soul_blades', 'name' => 'Духовные клинки', 'description' => 'Самонаведение: потратьте Псионическую энергию, чтобы бросить её и добавить к атаке. Психический телепорт: бонусным действием метните клинок и телепортируйтесь на 18м.'],
                    ],
                    '13' => [
                        ['key' => 'psychic_veil', 'name' => 'Психическая завеса', 'description' => 'Действием вы становитесь невидимым на 1 час или пока не атакуете/не заставите существо делать спасбросок. Раз за продолжительный отдых или за Псионическую энергию.'],
                    ],
                    '17' => [
                        ['key' => 'rend_mind', 'name' => 'Терзание разума', 'description' => 'При Скрытой атаке Психическим клинком цель делает спасбросок Мудрости или ошеломлена до конца вашего следующего хода. Раз за продолжительный отдых или за 3 Псионические энергии.'],
                    ],
                ],
            ],
            [
                'slug' => 'inquisitive',
                'name' => ['ru' => 'Инквизитор'],
                'parent_slug' => 'rogue',
                'description' => ['ru' => 'Вы — мастер раскрытия секретов и разгадывания тайн. Детективы, следователи и охотники за нежитью часто следуют этому архетипу.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'ear_for_deceit', 'name' => 'Ухо за обманом', 'description' => 'Когда делаете проверку Проницательности против Обмана, минимальный результат на кости = 8.'],
                        ['key' => 'eye_for_detail', 'name' => 'Глаз за деталью', 'description' => 'Бонусным действием вы можете совершить проверку Внимательности (найти скрытое) или Расследования (найти улики).'],
                        ['key' => 'insightful_fighting', 'name' => 'Проницательный бой', 'description' => 'Бонусным действием сделайте проверку Проницательности против Обмана цели. При успехе вы можете использовать Скрытую атаку без преимущества в течение 1 минуты.'],
                    ],
                    '9' => [
                        ['key' => 'steady_eye', 'name' => 'Твёрдый взгляд', 'description' => 'Преимущество на проверки Внимательности и Расследования, если перемещаетесь не более чем на половину скорости.'],
                    ],
                    '13' => [
                        ['key' => 'unerring_eye', 'name' => 'Безошибочный глаз', 'description' => 'Действием вы чувствуете иллюзии, перевёртышей и другой обман в пределах 9м. Число раз = бонус МДР за продолжительный отдых.'],
                    ],
                    '17' => [
                        ['key' => 'eye_for_weakness', 'name' => 'Глаз за слабостью', 'description' => 'Пока действует Проницательный бой, ваша Скрытая атака наносит дополнительно 3d6 урона.'],
                    ],
                ],
            ],
            [
                'slug' => 'phantom',
                'name' => ['ru' => 'Фантом'],
                'parent_slug' => 'rogue',
                'description' => ['ru' => 'Вы ходите по границе жизни и смерти. Связь с мёртвыми даёт вам странные способности и знания, недоступные обычным смертным.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'whispers_of_the_dead', 'name' => 'Шёпот мёртвых', 'description' => 'После отдыха вы получаете владение одним навыком или инструментом (призрак учит вас). Меняется после следующего отдыха.'],
                        ['key' => 'wails_from_the_grave', 'name' => 'Вой из могилы', 'description' => 'При Скрытой атаке вы можете направить некротическую энергию на второе существо в пределах 9м. Оно получает половину костей Скрытой атаки некротического урона.'],
                    ],
                    '9' => [
                        ['key' => 'tokens_of_the_departed', 'name' => 'Реликвии ушедших', 'description' => 'Когда существо в пределах 9м умирает, вы можете реакцией захватить часть его души (токен). Максимум = бонус мастерства токенов. Токен даёт преимущество на проверки Телосложения и спасброски от смерти.'],
                    ],
                    '13' => [
                        ['key' => 'ghost_walk', 'name' => 'Призрачная походка', 'description' => 'Бонусным действием вы становитесь призрачным на 10 минут: скорость полёта 3м (зависание), можете проходить сквозь существ и предметы. Раз за продолжительный отдых или уничтожив токен.'],
                    ],
                    '17' => [
                        ['key' => 'deaths_friend', 'name' => 'Друг смерти', 'description' => 'Вой из могилы теперь наносит полный урон Скрытой атаки. После продолжительного отдыха, если нет токенов, один появляется автоматически.'],
                    ],
                ],
            ],
            [
                'slug' => 'swashbuckler',
                'name' => ['ru' => 'Ловкач'],
                'parent_slug' => 'rogue',
                'description' => ['ru' => 'Вы сосредоточены на скорости, элегантности и обаянии в равной степени. Пираты, дуэлянты и бретёры — типичные представители этого архетипа.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'fancy_footwork', 'name' => 'Изящная работа ног', 'description' => 'Если вы атакуете существо в рукопашной, оно не может провоцировать от вас до конца хода, независимо от попадания.'],
                        ['key' => 'rakish_audacity', 'name' => 'Дерзкая отвага', 'description' => '+ХАР к инициативе. Скрытая атака работает, если в пределах 1.5м от цели нет других существ, даже без преимущества.'],
                    ],
                    '9' => [
                        ['key' => 'panache', 'name' => 'Панаш', 'description' => 'Действием вы очаровываете или провоцируете существо через проверку Убеждения против его Проницательности.'],
                    ],
                    '13' => [
                        ['key' => 'elegant_maneuver', 'name' => 'Элегантный манёвр', 'description' => 'Бонусным действием получите преимущество на следующую проверку Акробатики или Атлетики в этом ходу.'],
                    ],
                    '17' => [
                        ['key' => 'master_duelist', 'name' => 'Мастер дуэлей', 'description' => 'Если промахнулись атакой, вы можете перебросить с преимуществом. Раз за короткий отдых.'],
                    ],
                ],
            ],
        ];

        foreach ($subclasses as $data) {
            $subclass = CharacterClass::updateOrCreate(
                ['slug' => $data['slug']],
                array_merge($data, [
                    'hit_die' => 'd8',
                    'is_spellcaster' => $data['slug'] === 'arcane-trickster',
                    'spellcasting_ability' => $data['slug'] === 'arcane-trickster' ? 'intelligence' : null,
                    'is_system' => true,
                ])
            );

            if ($eberron) {
                $subclass->settings()->syncWithoutDetaching([$eberron->id]);
            }
        }

        $this->command->info('Rogue archetypes seeded: 8');
    }

    private function seedWizardSchools(?Setting $eberron): void
    {
        $subclasses = [
            [
                'slug' => 'school-of-abjuration',
                'name' => ['ru' => 'Школа Ограждения'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Школа Ограждения делает упор на магию, которая блокирует, изгоняет или защищает. Маги-ограждатели — востребованные защитники.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'abjuration_savant', 'name' => 'Знаток ограждения', 'description' => 'Золото и время на копирование заклинаний ограждения в книгу заклинаний уменьшаются вдвое.'],
                        ['key' => 'arcane_ward', 'name' => 'Магический щит', 'description' => 'При накладывании заклинания ограждения 1+ уровня вы создаёте щит с хитами = уровень волшебника × 2 + ИНТ. Поглощает урон вместо вас.'],
                    ],
                    '6' => [
                        ['key' => 'projected_ward', 'name' => 'Проецируемый щит', 'description' => 'Реакцией вы можете заставить щит поглотить урон существа в пределах 9м.'],
                    ],
                    '10' => [
                        ['key' => 'improved_abjuration', 'name' => 'Улучшенное ограждение', 'description' => 'Добавляйте бонус мастерства к проверкам способностей для заклинаний ограждения (Рассеивание магии, Контрзаклинание).'],
                    ],
                    '14' => [
                        ['key' => 'spell_resistance', 'name' => 'Сопротивление заклинаниям', 'description' => 'Преимущество на спасброски от заклинаний. Сопротивление урону от заклинаний.'],
                    ],
                ],
            ],
            [
                'slug' => 'school-of-conjuration',
                'name' => ['ru' => 'Школа Вызова'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Волшебники школы Вызова специализируются на призыве существ и предметов, а также на телепортации.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'conjuration_savant', 'name' => 'Знаток вызова', 'description' => 'Золото и время на копирование заклинаний вызова уменьшаются вдвое.'],
                        ['key' => 'minor_conjuration', 'name' => 'Малый вызов', 'description' => 'Действием создайте неодушевлённый предмет (до 1м, 5кг) на 1 час. Предмет светится тускло. Исчезает при уроне.'],
                    ],
                    '6' => [
                        ['key' => 'benign_transposition', 'name' => 'Безобидное перемещение', 'description' => 'Действием телепортируйтесь на 9м или поменяйтесь местами с согласным существом. Раз за продолжительный отдых или после заклинания вызова.'],
                    ],
                    '10' => [
                        ['key' => 'focused_conjuration', 'name' => 'Сосредоточенный вызов', 'description' => 'Получение урона не может нарушить вашу концентрацию на заклинании вызова.'],
                    ],
                    '14' => [
                        ['key' => 'durable_summons', 'name' => 'Стойкие призывы', 'description' => 'Существа, призванные вашими заклинаниями, получают 30 временных хитов.'],
                    ],
                ],
            ],
            [
                'slug' => 'school-of-divination',
                'name' => ['ru' => 'Школа Прорицания'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Прорицатели стремятся раздвинуть завесу пространства, времени и сознания, чтобы увидеть то, что скрыто от других.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'divination_savant', 'name' => 'Знаток прорицания', 'description' => 'Золото и время на копирование заклинаний прорицания уменьшаются вдвое.'],
                        ['key' => 'portent', 'name' => 'Предзнаменование', 'description' => 'После продолжительного отдыха бросьте 2d20 и запишите результаты. Любой бросок атаки, спасброска или проверки существа в вашем поле зрения можно заменить на записанный результат.'],
                    ],
                    '6' => [
                        ['key' => 'expert_divination', 'name' => 'Мастер прорицания', 'description' => 'При накладывании заклинания прорицания 2+ уровня восстановите одну ячейку (уровень = уровень заклинания - 1, максимум 5).'],
                    ],
                    '10' => [
                        ['key' => 'the_third_eye', 'name' => 'Третий глаз', 'description' => 'Действием выберите: Тёмное зрение 36м, Эфирное зрение, Понимание языков, или Невидимость в пределах 3м. До короткого отдыха.'],
                    ],
                    '14' => [
                        ['key' => 'greater_portent', 'name' => 'Великое предзнаменование', 'description' => 'Теперь вы бросаете 3d20 для Предзнаменования.'],
                    ],
                ],
            ],
            [
                'slug' => 'school-of-enchantment',
                'name' => ['ru' => 'Школа Очарования'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Чародеи-очарователи овладели магией, которая зачаровывает разумы других, подавляя волю или даря иллюзию дружбы.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'enchantment_savant', 'name' => 'Знаток очарования', 'description' => 'Золото и время на копирование заклинаний очарования уменьшаются вдвое.'],
                        ['key' => 'hypnotic_gaze', 'name' => 'Гипнотический взгляд', 'description' => 'Действием очаруйте существо в пределах 1.5м (если видит вас). Оно недееспособно и скорость = 0. До конца вашего хода (можно продлевать действием).'],
                    ],
                    '6' => [
                        ['key' => 'instinctive_charm', 'name' => 'Инстинктивное очарование', 'description' => 'Реакцией на атаку существа в пределах 9м, заставьте его атаковать ближайшее существо (кроме вас). Спасбросок МДР. Раз за продолжительный отдых.'],
                    ],
                    '10' => [
                        ['key' => 'split_enchantment', 'name' => 'Разделённое очарование', 'description' => 'Заклинание очарования 1 цели может поразить вторую цель в радиусе действия.'],
                    ],
                    '14' => [
                        ['key' => 'alter_memories', 'name' => 'Изменение памяти', 'description' => 'Очарованная вами цель не помнит, что была очарована. Кроме того, раз перед окончанием очарования вы можете стереть до 1+ИНТ часов памяти.'],
                    ],
                ],
            ],
            [
                'slug' => 'school-of-evocation',
                'name' => ['ru' => 'Школа Воплощения'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Воплотители сосредоточены на мощной элементальной магии: огненные шары, ледяные штормы, молнии и прочие разрушительные силы.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'evocation_savant', 'name' => 'Знаток воплощения', 'description' => 'Золото и время на копирование заклинаний воплощения уменьшаются вдвое.'],
                        ['key' => 'sculpt_spells', 'name' => 'Ваяние заклинаний', 'description' => 'Выберите 1+уровень заклинания существ в зоне вашего заклинания воплощения. Они автоматически успешны на спасброске и не получают урона при успехе.'],
                    ],
                    '6' => [
                        ['key' => 'potent_cantrip', 'name' => 'Мощный заговор', 'description' => 'Ваши заговоры с уроном наносят половину урона при успешном спасброске (вместо 0).'],
                    ],
                    '10' => [
                        ['key' => 'empowered_evocation', 'name' => 'Усиленное воплощение', 'description' => 'Добавляйте модификатор ИНТ к одному броску урона любого заклинания воплощения волшебника.'],
                    ],
                    '14' => [
                        ['key' => 'overchannel', 'name' => 'Перегрузка', 'description' => 'Заклинание волшебника 1-5 уровня наносит максимальный урон. При повторном использовании — 2d12 некротического урона за каждый уровень заклинания (накапливается).'],
                    ],
                ],
            ],
            [
                'slug' => 'school-of-illusion',
                'name' => ['ru' => 'Школа Иллюзии'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Иллюзионисты изучают магию обмана чувств, создавая фантомные образы, звуки и даже ощущения, неотличимые от реальности.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'illusion_savant', 'name' => 'Знаток иллюзий', 'description' => 'Золото и время на копирование заклинаний иллюзии уменьшаются вдвое.'],
                        ['key' => 'improved_minor_illusion', 'name' => 'Улучшенная малая иллюзия', 'description' => 'Вы изучаете заговор Малая иллюзия (не считается в лимит). Вы можете создавать звук И образ одновременно.'],
                    ],
                    '6' => [
                        ['key' => 'malleable_illusions', 'name' => 'Податливые иллюзии', 'description' => 'Действием вы можете изменить природу иллюзии (если её параметры позволяют).'],
                    ],
                    '10' => [
                        ['key' => 'illusory_self', 'name' => 'Иллюзорный двойник', 'description' => 'Реакцией на атаку создайте иллюзорную копию — атака автоматически промахивается. Раз за короткий отдых.'],
                    ],
                    '14' => [
                        ['key' => 'illusory_reality', 'name' => 'Иллюзорная реальность', 'description' => 'Бонусным действием сделайте один неодушевлённый объект в вашей иллюзии реальным на 1 минуту. Объект не может наносить урон напрямую.'],
                    ],
                ],
            ],
        ];

        foreach ($subclasses as $data) {
            $subclass = CharacterClass::updateOrCreate(
                ['slug' => $data['slug']],
                array_merge($data, [
                    'hit_die' => 'd6',
                    'is_spellcaster' => true,
                    'spellcasting_ability' => 'intelligence',
                    'is_system' => true,
                ])
            );

            if ($eberron) {
                $subclass->settings()->syncWithoutDetaching([$eberron->id]);
            }
        }

        $this->seedWizardSchoolsPart2($eberron);
    }

    private function seedWizardSchoolsPart2(?Setting $eberron): void
    {
        $subclasses = [
            [
                'slug' => 'school-of-necromancy',
                'name' => ['ru' => 'Школа Некромантии'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Некроманты исследуют космические силы жизни, смерти и нежити. Одни стремятся к бессмертию, другие — к армии послушных мертвецов.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'necromancy_savant', 'name' => 'Знаток некромантии', 'description' => 'Золото и время на копирование заклинаний некромантии уменьшаются вдвое.'],
                        ['key' => 'grim_harvest', 'name' => 'Мрачная жатва', 'description' => 'Раз в ход при убийстве существа заклинанием 1+ уровня восстановите хиты = уровень × 2 (или × 3 для некромантии). Не работает на конструктах и нежити.'],
                    ],
                    '6' => [
                        ['key' => 'undead_thralls', 'name' => 'Порабощённая нежить', 'description' => 'При поднятии нежити (Оживление мёртвых, и т.д.) можете поднять +1 существо. Нежить получает +ваш уровень волшебника хитов и +бонус мастерства к урону оружием.'],
                    ],
                    '10' => [
                        ['key' => 'inured_to_undeath', 'name' => 'Привыкший к нежизни', 'description' => 'Сопротивление некротическому урону. Максимум хитов не может быть уменьшен.'],
                    ],
                    '14' => [
                        ['key' => 'command_undead', 'name' => 'Власть над нежитью', 'description' => 'Действием подчините нежить (спасбросок ХАР). Разумная нежить повторяет спасбросок каждый час. Одна нежить за раз.'],
                    ],
                ],
            ],
            [
                'slug' => 'school-of-transmutation',
                'name' => ['ru' => 'Школа Преобразования'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Преобразователи — мастера изменения энергии и материи. Они превращают свинец в золото, а врагов — в безобидных животных.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'transmutation_savant', 'name' => 'Знаток преобразования', 'description' => 'Золото и время на копирование заклинаний преобразования уменьшаются вдвое.'],
                        ['key' => 'minor_alchemy', 'name' => 'Малая алхимия', 'description' => 'За 10 минут превратите до куба 30см одного вещества (дерево, камень, железо, медь, серебро) в другое. Длится 1 час или до потери концентрации.'],
                    ],
                    '6' => [
                        ['key' => 'transmuters_stone', 'name' => 'Камень преобразователя', 'description' => 'За 8 часов создайте камень с одним эффектом: +3м скорости, владение Телосложением, тёмное зрение 18м, или сопротивление кислоте/холоду/огню/молнии/звуку. Действием можете сменить эффект.'],
                    ],
                    '10' => [
                        ['key' => 'shapechanger', 'name' => 'Перевёртыш', 'description' => 'Добавьте Превращение в книгу. Вы можете творить его без ячейки (только на себя). Раз за короткий отдых.'],
                    ],
                    '14' => [
                        ['key' => 'master_transmuter', 'name' => 'Мастер преобразования', 'description' => 'Действием уничтожьте камень и получите один эффект: превратить 5-футовый куб в другой материал, убрать все проклятия/яды/болезни и восстановить 2d6 хитов, поднять мёртвого (как Воскрешение, 1 минута), или восстановить молодость (минус 3d10 лет).'],
                    ],
                ],
            ],
            [
                'slug' => 'war-magic',
                'name' => ['ru' => 'Боевая магия'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Боевые маги обучены использовать магию как на поле боя, так и в дуэлях. Они сочетают разрушительную мощь с тактической защитой.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'arcane_deflection', 'name' => 'Магическое отклонение', 'description' => 'Реакцией получите +2 КД против атаки или +4 к спасброску. После этого только заговоры до конца следующего хода.'],
                        ['key' => 'tactical_wit', 'name' => 'Тактический ум', 'description' => 'Добавляйте модификатор ИНТ к проверкам инициативы.'],
                    ],
                    '6' => [
                        ['key' => 'power_surge', 'name' => 'Всплеск силы', 'description' => 'Накапливайте всплески (максимум = ИНТ) при рассеивании заклинаний или при коротком отдыхе (1). Раз в ход потратьте всплеск, чтобы добавить половину уровня волшебника к урону заклинания.'],
                    ],
                    '10' => [
                        ['key' => 'durable_magic', 'name' => 'Стойкая магия', 'description' => 'Пока концентрируетесь на заклинании: +2 КД и ко всем спасброскам.'],
                    ],
                    '14' => [
                        ['key' => 'deflecting_shroud', 'name' => 'Отражающий покров', 'description' => 'При использовании Магического отклонения до 3 существ в пределах 18м получают силовой урон = половина уровня волшебника.'],
                    ],
                ],
            ],
            [
                'slug' => 'chronurgy-magic',
                'name' => ['ru' => 'Хронургия'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Хронурги манипулируют потоком времени. Эта редкая магия позволяет замедлять врагов, ускорять союзников и даже замораживать мгновения.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'chronal_shift', 'name' => 'Хрональный сдвиг', 'description' => 'Реакцией после броска атаки/спасброска/проверки в пределах 9м заставьте перебросить. Число раз = бонус ИНТ за продолжительный отдых.'],
                        ['key' => 'temporal_awareness', 'name' => 'Временное осознание', 'description' => 'Добавляйте модификатор ИНТ к проверкам инициативы.'],
                    ],
                    '6' => [
                        ['key' => 'momentary_stasis', 'name' => 'Мгновенный стазис', 'description' => 'Действием заморозьте Большое или меньшее существо в пределах 18м. Спасбросок ТЕЛ или недееспособно до конца вашего хода. Заканчивается при уроне. Число раз = бонус ИНТ.'],
                    ],
                    '10' => [
                        ['key' => 'arcane_abeyance', 'name' => 'Магическая приостановка', 'description' => 'Заклинание 1-4 уровня можно «заморозить» в бусине. Любое существо может бонусным действием высвободить заклинание. Раз за короткий отдых.'],
                    ],
                    '14' => [
                        ['key' => 'convergent_future', 'name' => 'Сходящееся будущее', 'description' => 'Реакцией решите, успешен или провален бросок атаки/спасброска/проверки в пределах 18м. При использовании — истощение (снимается только отдыхом).'],
                    ],
                ],
            ],
            [
                'slug' => 'graviturgy-magic',
                'name' => ['ru' => 'Гравитургия'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Гравитурги контролируют гравитацию. Они могут сделать врагов неподъёмно тяжёлыми или позволить союзникам парить в воздухе.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'adjust_density', 'name' => 'Изменение плотности', 'description' => 'Действием удвойте или уполовиньте вес Большого или меньшего существа/объекта в пределах 9м на 1 минуту. Тяжелее: -3м скорости, преимущество на СИЛ/помеха на ЛОВ. Легче: +3м, 2× прыжок, помеха СИЛ/преимущество ЛОВ.'],
                    ],
                    '6' => [
                        ['key' => 'gravity_well', 'name' => 'Гравитационный колодец', 'description' => 'При попадании заклинанием по существу вы можете сдвинуть его на 1.5м к вам или от вас (если оно не более чем на 1 размер больше вас).'],
                    ],
                    '10' => [
                        ['key' => 'violent_attraction', 'name' => 'Бурное притяжение', 'description' => 'Реакцией увеличьте урон падения на 2d10 (в пределах 18м) или добавьте 1d10 к урону оружием (в пределах 18м). Число раз = бонус ИНТ.'],
                    ],
                    '14' => [
                        ['key' => 'event_horizon', 'name' => 'Горизонт событий', 'description' => 'Действием создайте ауру 9м на концентрацию до 1 минуты. Враги при входе/начале хода: спасбросок СИЛ или 2d10 силового урона и скорость 0 до начала следующего хода. Раз за продолжительный отдых или за ячейку 3+.'],
                    ],
                ],
            ],
            [
                'slug' => 'order-of-scribes',
                'name' => ['ru' => 'Орден Писцов'],
                'parent_slug' => 'wizard',
                'description' => ['ru' => 'Писцы относятся к своей книге заклинаний как к живому спутнику. Их магические книги обретают собственное сознание и помогают волшебнику.'],
                'level_features' => [
                    '2' => [
                        ['key' => 'wizardly_quill', 'name' => 'Волшебное перо', 'description' => 'Бонусным действием создайте магическое перо. Копирование заклинаний занимает 2 минуты за уровень (вместо часа). Перо не требует чернил.'],
                        ['key' => 'awakened_spellbook', 'name' => 'Пробуждённая книга заклинаний', 'description' => 'Книга — фокус. При сотворении заклинания можете заменить тип урона на тип другого заклинания того же уровня в книге. Раз за продолжительный отдых творите ритуал за обычное время.'],
                    ],
                    '6' => [
                        ['key' => 'manifest_mind', 'name' => 'Проявление разума', 'description' => 'Бонусным действием призовите призрачный разум книги в пределах 18м. Вы можете видеть/слышать через него, творить заклинания из его позиции. Число раклинаний = бонус мастерства за продолжительный отдых.'],
                    ],
                    '10' => [
                        ['key' => 'master_scrivener', 'name' => 'Мастер-писец', 'description' => 'После продолжительного отдыха создайте свиток заклинания 1-2 уровня из книги. Свиток сотворяется на 1 уровень выше и не требует ячейки. Исчезает при следующем отдыхе.'],
                    ],
                    '14' => [
                        ['key' => 'one_with_the_word', 'name' => 'Единство со словом', 'description' => 'Преимущество на проверки Магии. При падении до 0 хитов (реакция) можете остаться на 1 хите, но заклинание 3+ уровня исчезает из книги (можно восстановить обычным способом). Раз за продолжительный отдых.'],
                    ],
                ],
            ],
        ];

        foreach ($subclasses as $data) {
            $subclass = CharacterClass::updateOrCreate(
                ['slug' => $data['slug']],
                array_merge($data, [
                    'hit_die' => 'd6',
                    'is_spellcaster' => true,
                    'spellcasting_ability' => 'intelligence',
                    'is_system' => true,
                ])
            );

            if ($eberron) {
                $subclass->settings()->syncWithoutDetaching([$eberron->id]);
            }
        }

        $this->command->info('Wizard schools seeded: 12');
    }

    private function seedArtificer(?Setting $eberron): void
    {
        // First, create the base Artificer class
        $artificer = CharacterClass::updateOrCreate(
            ['slug' => 'artificer'],
            [
                'name' => ['ru' => 'Изобретатель'],
                'description' => ['ru' => 'Мастера изобретения магических устройств. Изобретатели используют изобретательность и магию для создания необычных устройств. Они видят магию как сложную систему, которую можно декодировать и встроить в предметы.'],
                'hit_die' => 'd8',
                'primary_abilities' => ['intelligence'],
                'saving_throws' => ['constitution', 'intelligence'],
                'armor_proficiencies' => ['light', 'medium', 'shields'],
                'weapon_proficiencies' => ['simple'],
                'tool_proficiencies' => ['thieves_tools', 'tinkers_tools', 'one_artisan'],
                'skill_choices' => 2,
                'skill_options' => ['arcana', 'history', 'investigation', 'medicine', 'nature', 'perception', 'sleight_of_hand'],
                'starting_equipment' => [
                    ['choice' => 1, 'options' => [
                        [['item' => 'simple-weapon', 'qty' => 2]],
                        [['item' => 'light-crossbow', 'qty' => 1], ['item' => 'bolts', 'qty' => 20]],
                    ]],
                    ['item' => 'scale-mail', 'qty' => 1],
                    ['item' => 'thieves-tools', 'qty' => 1],
                    ['item' => 'dungeoneers-pack', 'qty' => 1],
                ],
                'starting_gold_formula' => '5d4 * 10',
                'level_features' => [
                    '1' => [
                        ['key' => 'magical_tinkering', 'name' => 'Магическое изобретательство', 'description' => 'Прикоснувшись к Крошечному немагическому предмету, вы можете наделить его одним из свойств: излучение света 3м, запись сообщения 6 секунд, издавание звука/запаха, статичный визуальный эффект. Число предметов = бонус ИНТ.'],
                        ['key' => 'spellcasting_artificer', 'name' => 'Использование заклинаний', 'description' => 'Вы изучили работу магии и можете создавать заклинательные эффекты через инструменты. Способность заклинаний: Интеллект. Вам нужны инструменты как фокус.'],
                    ],
                    '2' => [
                        ['key' => 'infuse_item', 'name' => 'Наполнение предмета', 'description' => 'Вы получаете способность наделять предметы магией. Изучаете 4 изобретения (больше с уровнем). После продолжительного отдыха можете коснуться предметов и наделить их свойствами. Число наполненных = половина уровня изобретателя (округляя вверх).'],
                    ],
                    '3' => [
                        ['key' => 'artificer_specialist', 'name' => 'Специализация изобретателя', 'description' => 'Выберите специализацию: Алхимик, Оружейник, Артиллерист или Боевой кузнец.', 'type' => 'subclass'],
                        ['key' => 'the_right_tool_for_the_job', 'name' => 'Подходящий инструмент', 'description' => 'За 1 час работы вы создаёте набор ремесленных инструментов в пустом пространстве. Создание магическое и исчезает при создании нового.'],
                    ],
                    '4' => [
                        ['key' => 'ability_score_improvement', 'name' => 'Увеличение характеристик', 'description' => '+2 к одной характеристике (максимум 20) или +1 к двум, или черта.'],
                    ],
                    '5' => [
                        ['key' => 'artificer_specialist_feature', 'name' => 'Умение специализации', 'description' => 'Вы получаете умение, определяемое вашей специализацией.'],
                    ],
                ],
                'progression' => [
                    '1' => ['proficiency_bonus' => 2, 'infusions_known' => 0, 'infused_items' => 0],
                    '2' => ['proficiency_bonus' => 2, 'infusions_known' => 4, 'infused_items' => 2],
                    '3' => ['proficiency_bonus' => 2, 'infusions_known' => 4, 'infused_items' => 2],
                    '4' => ['proficiency_bonus' => 2, 'infusions_known' => 4, 'infused_items' => 2],
                    '5' => ['proficiency_bonus' => 3, 'infusions_known' => 4, 'infused_items' => 2],
                ],
                'is_spellcaster' => true,
                'spellcasting_ability' => 'intelligence',
                'spell_slots' => [
                    '1' => ['cantrips' => 2, '1st' => 2],
                    '2' => ['cantrips' => 2, '1st' => 2],
                    '3' => ['cantrips' => 2, '1st' => 3],
                    '4' => ['cantrips' => 2, '1st' => 3],
                    '5' => ['cantrips' => 2, '1st' => 4, '2nd' => 2],
                ],
                'subclass_level' => 3,
                'subclass_name' => ['ru' => 'Специализация изобретателя'],
                'is_system' => true,
                'sort_order' => 13,
            ]
        );

        if ($eberron) {
            $artificer->settings()->syncWithoutDetaching([$eberron->id]);
        }

        // Now add the 4 specializations as subclasses
        $subclasses = [
            [
                'slug' => 'alchemist',
                'name' => ['ru' => 'Алхимик'],
                'parent_slug' => 'artificer',
                'description' => ['ru' => 'Алхимик специализируется на использовании реагентов для создания магических зелий и эликсиров с различными эффектами.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'tool_proficiency', 'name' => 'Владение инструментами', 'description' => 'Вы получаете владение инструментами алхимика. Если уже владеете — выберите другие ремесленные инструменты.'],
                        ['key' => 'alchemist_spells', 'name' => 'Заклинания алхимика', 'description' => 'Вы всегда имеете подготовленными: Лечение ран, Луч болезни (3), Пылающий шар, Кислотная стрела Мельфа (5), Газообразная форма, Массовое лечение ран (9), Порча, Каменная кожа (13), Высшее восстановление, Облачная смерть (17).'],
                        ['key' => 'experimental_elixir', 'name' => 'Экспериментальный эликсир', 'description' => 'После продолжительного отдыха создайте число эликсиров = бонус ИНТ (минимум 1). Эффект (d6): 1-Исцеление 2d4+ИНТ, 2-Скорость +3м, 3-Устойчивость +1 КД, 4-Отвага (иммунитет страху), 5-Изменение облика, 6-Полёт 3м.'],
                    ],
                    '5' => [
                        ['key' => 'alchemical_savant', 'name' => 'Алхимический знаток', 'description' => 'При сотворении заклинания через инструменты алхимика +ИНТ к одному броску исцеления или кислотного/огненного/некротического/ядовитого урона.'],
                    ],
                    '9' => [
                        ['key' => 'restorative_reagents', 'name' => 'Восстановительные реагенты', 'description' => 'При создании эликсира существо получает временные хиты = 2d6 + ИНТ. Вы можете сотворить Малое восстановление без ячейки (число раз = бонус ИНТ за продолжительный отдых).'],
                    ],
                    '15' => [
                        ['key' => 'chemical_mastery', 'name' => 'Химическое мастерство', 'description' => 'Сопротивление кислотному и ядовитому урону, иммунитет к отравлению. Вы можете сотворить Высшее восстановление и Исцеление без ячейки (по разу за продолжительный отдых).'],
                    ],
                ],
            ],
            [
                'slug' => 'armorer',
                'name' => ['ru' => 'Оружейник'],
                'parent_slug' => 'artificer',
                'description' => ['ru' => 'Оружейник модифицирует доспехи в магическую силовую броню, получая сверхъестественные способности.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'tools_of_the_trade', 'name' => 'Инструменты ремесла', 'description' => 'Вы получаете владение тяжёлыми доспехами и инструментами кузнеца.'],
                        ['key' => 'armorer_spells', 'name' => 'Заклинания оружейника', 'description' => 'Вы всегда имеете подготовленными: Волшебная стрела, Удар грома (3), Отражение, Сияющий путь (5), Гиперпространственный шаг, Молния (9), Огненный щит, Высшая невидимость (13), Облако тумана, Стена силы (17).'],
                        ['key' => 'arcane_armor', 'name' => 'Магическая броня', 'description' => 'Действием превратите доспех в магическую броню. Она покрывает вас, не даёт помех Скрытности, не требует СИЛ. Выберите модель: Страж (защита, кулаки 1d8 урона, притягивание) или Проникатель (мобильность, молнии 1d6, преимущество Скрытности).'],
                    ],
                    '5' => [
                        ['key' => 'extra_attack', 'name' => 'Дополнительная атака', 'description' => 'Вы можете атаковать дважды вместо одного раза при действии Атака.'],
                    ],
                    '9' => [
                        ['key' => 'armor_modifications', 'name' => 'Модификации брони', 'description' => 'Броня считается отдельными частями для наполнения: шлем, нагрудник, перчатки, обувь. Максимум наполненных предметов +2.'],
                    ],
                    '15' => [
                        ['key' => 'perfected_armor', 'name' => 'Совершенная броня', 'description' => 'Страж: реакцией на попадание притяните врага и совершите атаку кулаком. Проникатель: атака молнией по любому числу существ в пределах 9м (бонус мастерства раз за продолжительный отдых).'],
                    ],
                ],
            ],
            [
                'slug' => 'artillerist',
                'name' => ['ru' => 'Артиллерист'],
                'parent_slug' => 'artificer',
                'description' => ['ru' => 'Артиллеристы специализируются на создании магических пушек и огневой поддержке. Их Элдритч-пушки уничтожают врагов издалека.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'tool_proficiency_art', 'name' => 'Владение инструментами', 'description' => 'Вы получаете владение инструментами плотника. Если уже владеете — выберите другие.'],
                        ['key' => 'artillerist_spells', 'name' => 'Заклинания артиллериста', 'description' => 'Вы всегда имеете подготовленными: Щит, Удар грома (3), Палящий луч, Разрушение (5), Огненный шар, Ветрорассекатель (9), Ледяной шторм, Стена огня (13), Конус холода, Стена силы (17).'],
                        ['key' => 'eldritch_cannon', 'name' => 'Элдритч-пушка', 'description' => 'Действием создайте Маленькую или Крошечную магическую пушку на 1 час. Типы: Огнемёт (конус 4.5м, 2d8 огня, ЛОВ спасбросок), Баллиста (дальнобойная атака 2d8 силы), Защитник (временные хиты 1d8+ИНТ в радиусе 3м).'],
                    ],
                    '5' => [
                        ['key' => 'arcane_firearm', 'name' => 'Магическое огнестрельное оружие', 'description' => 'Превратите жезл, посох или ствол в фокус для заклинаний изобретателя. +1d8 к одному броску урона заклинания.'],
                    ],
                    '9' => [
                        ['key' => 'explosive_cannon', 'name' => 'Взрывная пушка', 'description' => 'Урон пушки увеличивается до 3d8. Действием можете взорвать пушку: существа в пределах 6м получают 3d8 силового урона (ЛОВ спасбросок половина).'],
                    ],
                    '15' => [
                        ['key' => 'fortified_position', 'name' => 'Укреплённая позиция', 'description' => 'Вы и союзники получают полуукрытие в пределах 3м от пушки. Теперь можете иметь 2 пушки, и обе могут стрелять одним бонусным действием.'],
                    ],
                ],
            ],
            [
                'slug' => 'battle-smith',
                'name' => ['ru' => 'Боевой кузнец'],
                'parent_slug' => 'artificer',
                'description' => ['ru' => 'Боевые кузнецы создают стального защитника — верного конструкта-компаньона, сражающегося рядом с хозяином.'],
                'level_features' => [
                    '3' => [
                        ['key' => 'tool_proficiency_bs', 'name' => 'Владение инструментами', 'description' => 'Вы получаете владение инструментами кузнеца. Если уже владеете — выберите другие.'],
                        ['key' => 'battle_smith_spells', 'name' => 'Заклинания боевого кузнеца', 'description' => 'Вы всегда имеете подготовленными: Героизм, Щит (3), Духовное оружие, Палящий луч (5), Аура жизненной силы, Вызов конструктов (9), Аура чистоты, Огненный щит (13), Гейс, Стена силы (17).'],
                        ['key' => 'battle_ready', 'name' => 'Готовый к бою', 'description' => 'Вы получаете владение воинским оружием. При атаке магическим оружием можете использовать ИНТ вместо СИЛ/ЛОВ.'],
                        ['key' => 'steel_defender', 'name' => 'Стальной защитник', 'description' => 'Конструкт-компаньон, повинующийся вашим командам. Можете управлять бонусным действием. Может атаковать, Чинить, Защищать (реакция: помеха атаке по союзнику в пределах 1.5м).'],
                    ],
                    '5' => [
                        ['key' => 'extra_attack_bs', 'name' => 'Дополнительная атака', 'description' => 'Вы можете атаковать дважды вместо одного раза при действии Атака.'],
                    ],
                    '9' => [
                        ['key' => 'arcane_jolt', 'name' => 'Магический разряд', 'description' => 'Раз в ход при попадании магическим оружием или атакой Защитника +2d6 силового урона ИЛИ существо в пределах 9м восстанавливает 2d6 хитов. Число раз = бонус ИНТ.'],
                    ],
                    '15' => [
                        ['key' => 'improved_defender', 'name' => 'Улучшенный защитник', 'description' => 'Магический разряд наносит/лечит 4d6. Защитник получает +2 КД. Защитник может делать Deflect Attack, даже когда вы недееспособны.'],
                    ],
                ],
            ],
        ];

        foreach ($subclasses as $data) {
            $subclass = CharacterClass::updateOrCreate(
                ['slug' => $data['slug']],
                array_merge($data, [
                    'hit_die' => 'd8',
                    'is_spellcaster' => true,
                    'spellcasting_ability' => 'intelligence',
                    'is_system' => true,
                ])
            );

            if ($eberron) {
                $subclass->settings()->syncWithoutDetaching([$eberron->id]);
            }
        }

        $this->command->info('Artificer seeded: base class + 4 specializations');
    }
}
