# CLAUDE.md

This file provides guidance to Claude Code when working with this repository.

## Project Overview

**D&D Assistant** â€” Ğ²ĞµĞ±-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ°-Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸Ğº Ğ´Ğ»Ñ **Ğ¶Ğ¸Ğ²Ñ‹Ñ… Ğ½Ğ°ÑÑ‚Ğ¾Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞµÑÑĞ¸Ğ¹** D&D 5e. Ğ­Ñ‚Ğ¾ ĞĞ• Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° (Ğ½Ğµ Foundry VTT, Ğ½Ğµ Roll20). Ğ¦ĞµĞ»ÑŒ â€” ÑƒĞ±Ñ€Ğ°Ñ‚ÑŒ Ğ±ÑƒĞ¼Ğ°Ğ¶Ğ½ÑƒÑ Ğ²Ğ¾Ğ»Ğ¾ĞºĞ¸Ñ‚Ñƒ, Ğ¾ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºÑƒĞ±Ğ¸ĞºĞ¸, Ğ¾Ñ‚Ñ‹Ğ³Ñ€Ñ‹Ñˆ Ğ¸ ĞºĞ°Ğ¹Ñ„ Ğ¾Ñ‚ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ½Ğ¾Ğ¹ Ğ¸Ğ³Ñ€Ñ‹.

### Ğ¤Ğ¸Ğ»Ğ¾ÑĞ¾Ñ„Ğ¸Ñ

> Ğ›ÑƒÑ‡ÑˆĞ°Ñ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ Ğ·Ğ° ÑÑ‚Ğ¾Ğ»Ğ¾Ğ¼ â€” Ñ‚Ğ°, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ½ĞµĞ·Ğ°Ğ¼ĞµÑ‚Ğ½Ğ°.

**Ğ§Ñ‚Ğ¾ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ”Ğ•Ğ›ĞĞ•Ğ¢:**
- Ğ—Ğ°Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ±ÑƒĞ¼Ğ°Ğ¶Ğ½Ñ‹Ğµ Ğ»Ğ¸ÑÑ‚Ñ‹ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ĞµĞ¹ â†’ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½/Ğ¿Ğ»Ğ°Ğ½ÑˆĞµÑ‚ Ñƒ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ°
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚ Ğ¼Ğ¾Ğ´Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ğ¾Ğ², ĞšĞ”, Ğ±Ğ¾Ğ½ÑƒÑĞ¾Ğ²
- Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ·Ğ°ĞºĞ»Ğ¸Ğ½Ğ°Ğ½Ğ¸Ğ¹ Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ğ¼Ğ¸
- ĞŸÑƒĞ»ÑŒÑ‚ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ°Ñ‚Ğ¼Ğ¾ÑÑ„ĞµÑ€Ğ¾Ğ¹ Ğ´Ğ»Ñ DM â†’ Ğ¼ÑƒĞ·Ñ‹ĞºĞ°, ÑÑ†ĞµĞ½Ñ‹ Ğ½Ğ° Ğ¢Ğ’
- Ğ¢Ñ€ĞµĞºĞµÑ€ Ğ±Ğ¸Ñ‚Ğ²Ñ‹, Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ğ¾ÑÑ‚ĞµĞ¹, Ğ·Ğ°Ğ¼ĞµÑ‚ĞºĞ¸

**Ğ§Ñ‚Ğ¾ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° ĞĞ• Ğ”Ğ•Ğ›ĞĞ•Ğ¢:**
- ĞĞµ Ğ·Ğ°Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ¶Ğ¸Ğ²Ğ¾Ğµ Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ
- ĞĞµ Ğ·Ğ°Ğ¼ĞµĞ½ÑĞµÑ‚ Ñ„Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ĞºÑƒĞ±Ğ¸ĞºĞ¸
- ĞĞµ Ñ€Ğ¸ÑÑƒĞµÑ‚ ĞºĞ°Ñ€Ñ‚Ñ‹ Ğ¸ Ğ½Ğµ Ğ´Ğ²Ğ¸Ğ³Ğ°ĞµÑ‚ Ñ‚Ğ¾ĞºĞµĞ½Ñ‹ (Ğ½Ğµ battlemap VTT)

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“º Ğ‘Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ ÑĞºÑ€Ğ°Ğ½ (Display Client)          â”‚
â”‚  /display/screen â€” fullscreen, Ğ±ĞµĞ· UI       â”‚
â”‚                                             â”‚
â”‚  ğŸ’» ĞĞ¾ÑƒÑ‚Ğ±ÑƒĞº DM                             â”‚
â”‚  /dashboard/* â€” backoffice, ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ      â”‚
â”‚                                             â”‚
â”‚  ğŸ“±ğŸ“±ğŸ“± Ğ¢ĞµĞ»ĞµÑ„Ğ¾Ğ½Ñ‹ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ¾Ğ²                   â”‚
â”‚  /player/* â€” Ğ»Ğ¸ÑÑ‚ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ°                 â”‚
â”‚                                             â”‚
â”‚  ğŸ²ğŸ²ğŸ² ĞĞ°ÑÑ‚Ğ¾ÑÑ‰Ğ¸Ğµ ĞºÑƒĞ±Ğ¸ĞºĞ¸ Ğ½Ğ° ÑÑ‚Ğ¾Ğ»Ğµ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Documentation

ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ñ€Ğ°Ğ·Ğ±Ğ¸Ñ‚Ğ° Ğ¿Ğ¾ Ñ‚ĞµĞ¼Ğ°Ğ¼:

| Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ | Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ğµ |
|----------|------------|
| [docs/quick-start.md](docs/quick-start.md) | Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°, Docker, ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ |
| [docs/architecture.md](docs/architecture.md) | Tech stack, SOLID, ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ° |
| [docs/database.md](docs/database.md) | PostgreSQL JSONB, Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸, ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚ |
| [docs/api.md](docs/api.md) | API endpoints, services |
| [docs/frontend.md](docs/frontend.md) | Next.js, ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹, Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹ |
| [docs/dnd-localization.md](docs/dnd-localization.md) | Ğ ÑƒÑÑĞºĞ¸Ğµ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ñ‹ D&D, Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° |
| [docs/security.md](docs/security.md) | Auth, authorization, WebSocket security |
| [docs/deployment.md](docs/deployment.md) | Coolify, environment, media |
| [docs/status.md](docs/status.md) | Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ ÑÑ‚Ğ°Ñ‚ÑƒÑ, TODO, Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ñ‹ |

## Quick Start

```bash
# 1. Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ env Ñ„Ğ°Ğ¹Ğ»Ñ‹
cp apps/api/.env.example apps/api/.env
cp apps/web/.env.local.example apps/web/.env.local

# 2. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Docker (API + PostgreSQL + Redis + WebSocket)
npm run docker:up

# 3. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ„Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´
cd apps/web && npm install && npm run dev
```

ĞŸĞ¾ÑĞ»Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°:
- API: http://localhost:8000
- Frontend: http://localhost:3000
- Mailpit: http://localhost:8025

Ğ›Ğ¾Ğ³Ğ¸Ğ½: owner@example.com / password

## Tech Stack (ĞºÑ€Ğ°Ñ‚ĞºĞ¸Ğ¹)

| Layer | Technology |
|-------|-----------|
| Backend | Laravel 12, PHP 8.4 |
| Frontend | Next.js 16, React 19, TypeScript |
| Database | PostgreSQL 17 + JSONB |
| WebSocket | Laravel Reverb |
| Styling | Tailwind CSS 4, shadcn/ui |

## Current Status

**Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾:**
- âœ… Auth + Roles (owner/dm/player)
- âœ… Campaigns, Acts, Sessions CRUD
- âœ… Characters + Level Up + Inspiration
- âœ… DM Control Panel (HP, XP, conditions, custom rules, inventory, spells)
- âœ… WebSocket real-time sync
- âœ… Live Sessions Ñ presence

**TODO:**
- âŒ Display Client (TV mode)
- âŒ Battle Tracker
- âŒ Dice roller
- âŒ Scene Editor
- âŒ Character creation wizard

Ğ¡Ğ¼. [docs/status.md](docs/status.md) Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾ÑÑ‚ĞµĞ¹.

## Key Commands

```bash
# Docker
npm run docker:up       # Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ
npm run docker:down     # ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ
npm run docker:reset    # Ğ¡Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ²ÑÑ‘

# Laravel (Ñ‡ĞµÑ€ĞµĞ· Docker)
docker exec dnd_api php artisan migrate
docker exec dnd_api php artisan db:seed
docker exec dnd_api php artisan test

# Frontend
npm run dev             # Dev server
npm run build           # Ğ’ĞĞ–ĞĞ: Ğ¿ĞµÑ€ĞµĞ´ Ğ¿ÑƒÑˆĞµĞ¼!
npm run lint
```

## Project Structure

```
dnd-assistant/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ api/            # Laravel 12 API
â”‚   â””â”€â”€ web/            # Next.js 16 Frontend
â”œâ”€â”€ docs/               # Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ CLAUDE.md           # Ğ­Ñ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ»
```

## Coding Conventions

- Reference: XStream project (`C:\Projects\xstream-next`)
- API response: `{ success: true, data: {...}, meta: {...} }`
- TypeScript strict mode
- Ğ’ÑĞµĞ³Ğ´Ğ° `npm run build` Ğ¿ĞµÑ€ĞµĞ´ Ğ¿ÑƒÑˆĞµĞ¼
- Ğ ÑƒÑÑĞºĞ¸Ğ¹ ÑĞ·Ñ‹Ğº Ğ´Ğ»Ñ Ğ²ÑĞµĞ³Ğ¾ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ° D&D
- ĞœĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° (Ğ¼ĞµÑ‚Ñ€Ñ‹, ĞºĞ¸Ğ»Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñ‹)

## WebSocket Channels

- `campaign.{id}` â€” presence channel (ĞºÑ‚Ğ¾ Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½)
- `campaign.{id}.battle` â€” Ñ‚Ñ€ĞµĞºĞµÑ€ Ğ±Ğ¸Ñ‚Ğ²Ñ‹
- `campaign.{id}.display` â€” ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¢Ğ’
- `private-character.{id}` â€” Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğ¹ ĞºĞ°Ğ½Ğ°Ğ» DM â†” Ğ¸Ğ³Ñ€Ğ¾Ğº
